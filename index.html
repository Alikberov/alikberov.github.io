<html>
<head>
<title>Inter Windows</title>

<script type=module>
import potpack from "https://mapbox.github.io/potpack/index.js"
window.potpack = potpack;
</script>

<script>
var	scripts_counter = 0;
const	scripts_list = [
	"omni-window.js",
	"omni-icon.js",
//	"https://mapbox.github.io/potpack/index.js",
//	"https://raw.githubusercontent.com/mapbox/potpack/main/index.js",
	"https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js",
	"https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js",
	"https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js",
	"https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"
];

function script_loaded() {
	var	hfbs = document.getElementById("FireBaseStatus");
	hfbs.title = `${scripts_counter} scripts left`;
	console.log(`${-- scripts_counter} scripts left`);
	console.log(`${this.type}`);
	if(!scripts_counter) {
		document.getElementById("DoFloating").checked = true;
		[...document.getElementsByTagName("omni-window")].pop().bringToTop();
		hfbs.title = "Firebase is ready!";
		setTimeout(Connect, 5000);
	}
}

for(script_url of scripts_list) {
	var script_tag = document.createElement("script");
	if(script_url.match(/github/)) {
		script_tag.setAttribute("type", "module");
	} else
		script_tag.setAttribute("src", script_url);
	script_tag.addEventListener("load", script_loaded);
	document.head.appendChild(script_tag);
	scripts_counter ++;
}
</script>

<script>
function Connect() {
	document.body.addEventListener("dragover", function(e) {
		e.stopPropagation();
		e.preventDefault();
		e.dataTransfer.dropEffect = "copy";
	});
	document.body.addEventListener("drop", function(e) {
		e.stopPropagation();
		e.preventDefault();
		var files = e.dataTransfer.files; // Array of all files

		for (var i=0, file; file=files[i]; i++) {
			if (file.type.match(/image.*/)) {
				var reader = new FileReader();
				reader.onload = function(e2) {
					// finished reading file data.
					var img = document.createElement("img");
					img.src = e2.target.result;
					var lnk = document.createElement("img");
					lnk.src = "https://img.icons8.com/?size=100&id=67369&format=png&color=000000";
					lnk.addEventListener("click", (function(e) {
							//var	hOmni = document.createElement("omni-window");
							//hOmni.appendChild(this.img);
							//document.body.appendChild(hOmni);
							document.getElementById("Previewer").src = this.img.src;
						}).bind({img: img})
					);
					document.getElementById("Files").appendChild(lnk);
				}
				reader.readAsDataURL(file); // start reading the file data.
			}
		}
	});
	OmniWindow.prototype.arrange();
}
</script>


<style>
  user-card {
    --user-card-field-color: green;
  }
</style>

<template id="tmpl">
	<style>
	.omni-window-header {
		background	:var(--float-header-background, blue);
		color		:var(--float-header-color, white);
		cursor		:move;
		display		:block;
		margin		:0 0 0 0;
		padding		:0 0 0 0;
		width		:100%;
	}
	</style>
</template>

<style>
:root {
	--display-bg	:linear-gradient(45deg, #eee 25%, transparent 25%, transparent 75%, #eee 75%, #eee 100%)
			,linear-gradient(45deg, #eee 25%, #e8e8e8 25%, #e8e8e8 75%, #eee 75%, #eee 100%);
}

@keyframes canvasChecks {
	from {
		background-position: 0px 0px, 10px 10px;
	}

	to {
		background-position: 40px 20px, 50px 30px;
	}
}

canvas#Display
{
	/*position	:absolute;*/
}

body
{
	margin-top	:28px;
	margin-left	:0px;
	margin-right	:0px;
	margin-bottom	:14px;
	padding-top	:0px;
	padding-left	:0px;
	padding-right	:0px;
	padding-bottom	:0px;
	animation-duration: 30s;
	animation-timing-function: linear;
	--animation-name	:canvasChecks;
	animation-iteration-count: infinite;
	--background-position: 0px 0px, 10px 10px;
	--background-size	:20px 20px;
	--background-image:var(--display-bg);
	background-image:url('https://ia801705.us.archive.org/16/items/windows-xp-bliss-wallpaper/windows-xp-bliss-4k-lu-1920x1080.jpg');
	overflow	:hidden;
	flew-flow: row wrap;
	justify-content: space-between;
}

input#DoFloating {
	display	:none;
}
input ~ omni-window {
	position	:static;
}

input#DoFloating:checked ~ omni-window {
	position	:absolute;
}
input#DoFloating ~ omni-window label[for="DoFloating"] {
	border		:medium silver outset;
	background-color:silver;
}
input#DoFloating:checked ~ omni-window label[for="DoFloating"] {
	border		:medium silver inset;
}

omni-window {
	border		:medium silver outset;
	display		:inline-grid;
	margin		:0 0 0 0;
	padding		:0 0 0 0;
	position	:static;
	--float-header-background:linear-gradient(90deg, grey, #B5B5B5);
	min-height	:1em;
}
omni-window pre {
	margin-top	:0px;
	margin-bottom	:0px;
	overflow	:auto;
	resize		:both;
}
omni-window header {
	background	:linear-gradient(90deg, grey, #B5B5B5);
	color		:white;
	cursor		:move;
	display		:block;
	margin		:0 0 0 0;
	padding		:0 0 0 0;
	width		:100%;
}
omni-window[active] {
	--float-header-background:linear-gradient(90deg, navy, #10B4D0);
}

select#FloatList {
	display		:block;
}

video {
	resize		:both;
}
</style>
</head>

<body>
<input id=DoFloating type=checkbox checked />
<omni-window id=FireBaseStatus title='Firebase' drown></omni-window>
<omni-window title='Windows' for=FloatList drown>
<label for=DoFloating>Change Mode</label><button onclick='this.parentElement.arrange()'>Arrange</button>
<select id=FloatList></select>
</omni-window>
<omni-window title='Window "Div"'><div>Div-Tag</div></omni-window>
<omni-window title='Window "Pre"'><pre>Pre-Tag</pre></omni-window>
<omni-window title='Window "TextArea"'><textarea>TextArea-Tag</textarea></omni-window>
<omni-window title='Window "YouTube"' drown>
<iframe id=YouTube title='YouTube' width="560" height="315" src='https://www.youtube.com/embed/HiQrUDIah4E' title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; full-screen;" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
</omni-window>
<omni-window title='Window Manager'>
<form>
<table>
<tr><td>Title</td><td><input type=text name=title placeholder='Window caption' /></td></tr>
</table>
<select name=tagname>
<option value=''></option>
</select>
</form>
</omni-window>
<omni-window id=Files title='Files'>
<a href='fantaseur-proto.html'><img src='https://img.icons8.com/?size=100&id=K13CnWBxvKsl&format=png&color=000000' /></a>
</omni-window>
<omni-window id=Preview title='Preview'>
<img id=Previewer src='' />
</omni-window>
</body>
